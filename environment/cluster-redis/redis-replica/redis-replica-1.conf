# ============================
# Basic Redis replica configuration
# ============================

port 6379
# Cá»•ng Redis replica láº¯ng nghe. Máº·c Ä‘á»‹nh lÃ  6379.

dir /data
# ThÆ° má»¥c nÆ¡i Redis lÆ°u dá»¯ liá»‡u AOF/RDB.
# => Äáº£m báº£o /data tá»“n táº¡i vÃ  Redis cÃ³ quyá»n ghi.

# ============================
# Connect to master
# ============================

replicaof redis-master 6379
# Thiáº¿t láº­p Ä‘á»‹a chá»‰ Master Redis.
# => Trong Docker Compose, dÃ¹ng tÃªn service ("redis-master") thay vÃ¬ IP.

# If master has password:
# masterauth yourStrongPassword
# Náº¿u master yÃªu cáº§u máº­t kháº©u, cáº¥u hÃ¬nh masterauth Ä‘á»ƒ replica káº¿t ná»‘i thÃ nh cÃ´ng.

# ============================
# Read-only settings
# ============================

replica-read-only yes
# Cáº¥u hÃ¬nh replica chá»‰ cho phÃ©p Ä‘á»c (khÃ´ng cho phÃ©p ghi).
# => Gá»¢I Ã:
#    + NÃªn báº­t Ä‘á»ƒ trÃ¡nh ghi dá»¯ liá»‡u trá»±c tiáº¿p vÃ o replica gÃ¢y xung Ä‘á»™t.
#    + Náº¿u muá»‘n ghi lÃªn replica (trÆ°á»ng há»£p Ä‘áº·c biá»‡t), set replica-read-only no.

# ============================
# Persistence options (TÃ¹y chá»n lÆ°u trá»¯)
# ============================

# TODO: uncomment 
# appendonly yes
# # Ghi AOF file trÃªn Replica.

# appendfilename "appendonly.aof"
# # TÃªn file AOF lÆ°u trÃªn Ä‘Ä©a.

# appendfsync everysec
# # Flush AOF ra Ä‘Ä©a má»—i giÃ¢y.
# # => Gá»¢I Ã:
# #    + Náº¿u replica chá»§ yáº¿u Ä‘á»ƒ scale Ä‘á»c vÃ  sáºµn sÃ ng rebuild tá»« master, cÃ³ thá»ƒ cÃ¢n nháº¯c khÃ´ng cáº§n AOF.
# #    + appendonly no sáº½ giáº£m táº£i disk I/O cho Replica.
appendonly yes
save ""

# ============================
# Logging
# ============================

loglevel notice
# Má»©c Ä‘á»™ ghi log.

logfile ""
# Log ra stdout (thÆ°á»ng dÃ¹ng trong Docker).
# => Gá»¢I Ã: 
#    + Náº¿u cáº§n lÆ°u log ra file riÃªng, cáº¥u hÃ¬nh logfile "/var/log/redis/replica.log"

# ============================
# Security (Báº£o máº­t Redis)
# ============================

# requirepass yourStrongPassword
# Máº­t kháº©u báº£o vá»‡ replica.
# => Gá»¢I Ã:
#    + Báº®T BUá»˜C báº­t requirepass trong Production Ä‘á»ƒ báº£o vá»‡ Redis.

# ============================
# Performance tuning (Tá»‘i Æ°u hiá»‡u nÄƒng)
# ============================

# maxmemory 256mb
# Giá»›i háº¡n RAM Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn replica.
# => Gá»¢I Ã:
#    + NÃªn setup RAM riÃªng cho replica, trÃ¡nh tranh cháº¥p tÃ i nguyÃªn vá»›i master.

# maxmemory-policy allkeys-lru
# ChÃ­nh sÃ¡ch xÃ³a key khi háº¿t bá»™ nhá»›.

# CÃ¡c tinh chá»‰nh thÃªm náº¿u workload ráº¥t náº·ng:
# tcp-backlog 511
# client-output-buffer-limit normal 0 0 0
# client-output-buffer-limit pubsub 32mb 8mb 60

# Náº¿u replica load cao, kiá»ƒm tra thÃªm:
# repl-backlog-size 128mb
# => TÄƒng vÃ¹ng nhá»› dá»± phÃ²ng Ä‘á»ƒ há»— trá»£ viá»‡c sao chÃ©p nhanh chÃ³ng.

# ============================
# Other settings (Cáº¥u hÃ¬nh khÃ¡c)
# ============================

protected-mode no
# Táº¯t protected-mode.
# => Gá»¢I Ã:
#    + Náº¿u protected-mode táº¯t, cáº§n Ä‘áº£m báº£o cáº¥u hÃ¬nh requirepass vÃ  firewall Ä‘á»ƒ báº£o vá»‡.

# ============================
# Gá»¢I Ã Bá»” SUNG Tá»”NG THá»‚:
# ============================

# ğŸ’¡ Náº¿u má»¥c tiÃªu cá»§a Replica lÃ  Scale Ä‘á»c:
#    - appendonly no (giáº£m táº£i ghi disk).
#    - Ä‘áº£m báº£o replica-read-only yes.

# ğŸ’¡ Náº¿u Replica cáº§n sáºµn sÃ ng lÃ m Master khi failover:
#    - appendonly yes Ä‘á»ƒ háº¡n cháº¿ máº¥t dá»¯ liá»‡u.
#    - Ä‘áº£m báº£o cáº¥u hÃ¬nh Sentinel Ä‘Ãºng Ä‘á»ƒ tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i.

# ğŸ’¡ Tá»‘i Æ°u throughput Replica:
#    - TÄƒng máº¡ng (network) bÄƒng thÃ´ng cao.
#    - Tá»‘i Æ°u Ä‘Ä©a (SSD).
#    - Náº¿u server nhiá»u core, dÃ¹ng nhiá»u Redis replica nhá» thay vÃ¬ 1 to.

# ğŸ’¡ Náº¿u Replica sá»­ dá»¥ng Ä‘á»ƒ cache:
#    - CÃ³ thá»ƒ Ä‘áº·t eviction policy nhÆ° allkeys-lru, volatile-lru tÃ¹y mÃ´ hÃ¬nh.
