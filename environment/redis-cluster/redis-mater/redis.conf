# ============================
# Basic Redis master configuration
# ============================

port 6379
# Cá»•ng Redis láº¯ng nghe. Máº·c Ä‘á»‹nh lÃ  6379.
# => CÃ³ thá»ƒ Ä‘á»•i náº¿u cáº§n deploy nhiá»u Redis trÃªn cÃ¹ng server.

dir /data
# ThÆ° má»¥c nÆ¡i Redis lÆ°u dá»¯ liá»‡u (AOF/RDB). 
# => Äáº£m báº£o folder /data tá»“n táº¡i vÃ  Redis cÃ³ quyá»n ghi.

# ============================
# Persistence options (TÃ¹y chá»n lÆ°u trá»¯ dá»¯ liá»‡u)
# ============================

# TODO: uncomment 
# appendonly yes
# # Báº¬T cháº¿ Ä‘á»™ ghi AOF (Append Only File) - giÃºp giáº£m rá»§i ro máº¥t dá»¯ liá»‡u khi Redis crash.
# # => Gá»¢I Ã: 
# #    + Náº¿u TEST hiá»‡u nÄƒng (benchmark), nÃªn táº¡m thá»i táº¯t: appendonly no vÃ  save "" Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ ghi.

# appendfilename "appendonly.aof"
# # TÃªn file AOF sáº½ lÆ°u trÃªn á»• Ä‘Ä©a.

# appendfsync everysec
# # Redis flush AOF ra Ä‘Ä©a má»—i 1 giÃ¢y.
# # => Gá»¢I Ã: 
# #    + Náº¿u cáº§n hiá»‡u suáº¥t cao hÆ¡n, cÃ³ thá»ƒ dÃ¹ng appendfsync no (OS tá»± flush).
# #    + Náº¿u cáº§n Ä‘á»™ bá»n cao hÆ¡n (nhÆ°ng hiá»‡u suáº¥t tháº¥p hÆ¡n), dÃ¹ng appendfsync always.
appendonly no
save ""

# ============================
# Logging
# ============================

loglevel notice
# Má»©c Ä‘á»™ ghi log: debug, verbose, notice, warning.
# => Gá»¢I Ã: 
#    + "notice" lÃ  má»©c khuyáº¿n nghá»‹ cho Production (khÃ´ng quÃ¡ nhiá»u log, dá»… Ä‘á»c).

logfile ""
# Äá»ƒ trá»‘ng "" Ä‘á»ƒ log ra stdout (thÆ°á»ng dÃ¹ng trong Docker hoáº·c systemd).
# => Náº¿u cháº¡y server bÃ¬nh thÆ°á»ng, nÃªn log ra file riÃªng vÃ­ dá»¥: logfile "/var/log/redis/redis.log"

# ============================
# Security (Báº£o máº­t Redis)
# ============================

# requirepass yourStrongPassword
# Máº­t kháº©u báº£o vá»‡ Redis server.
# => Gá»¢I Ã: 
#    + Báº®T BUá»˜C báº­t requirepass trong mÃ´i trÆ°á»ng Production.
#    + Káº¿t há»£p firewall/Security Group Ä‘á»ƒ cháº·n truy cáº­p trÃ¡i phÃ©p vÃ o Redis port.

# ============================
# Performance tuning (Tá»‘i Æ°u hiá»‡u nÄƒng)
# ============================

# maxmemory 256mb
# Giá»›i háº¡n RAM Redis Ä‘Æ°á»£c phÃ©p sá»­ dá»¥ng.
# => Gá»¢I Ã:
#    + NÃªn thiáº¿t láº­p khoáº£ng 60%-80% RAM váº­t lÃ½ server.
#    + TrÃ¡nh Ä‘á»ƒ Redis chiáº¿m háº¿t RAM, gÃ¢y crash há»‡ thá»‘ng.

# maxmemory-policy allkeys-lru
# ChÃ­nh sÃ¡ch xÃ³a key khi háº¿t RAM.
# => Gá»¢I Ã:
#    + "allkeys-lru" = xÃ³a key Ã­t Ä‘Æ°á»£c sá»­ dá»¥ng gáº§n Ä‘Ã¢y nháº¥t, ráº¥t phÃ¹ há»£p cho cache server.
#    + Náº¿u yÃªu cáº§u khÃ¡c (vÃ­ dá»¥: chá»‰ xÃ³a key cÃ³ expire), dÃ¹ng volatile-lru.

# Má»™t sá»‘ tÃ¹y chá»‰nh thÃªm náº¿u muá»‘n scale táº£i cao:
# tcp-backlog 511
# => TÄƒng backlog TCP, cáº£i thiá»‡n kháº£ nÄƒng chá»‹u táº£i nhiá»u káº¿t ná»‘i Ä‘á»“ng thá»i.

# client-output-buffer-limit normal 0 0 0
# client-output-buffer-limit pubsub 32mb 8mb 60
# => Tá»‘i Æ°u giá»›i háº¡n buffer client, trÃ¡nh client bá»‹ treo.

# ============================
# Other settings (Cáº¥u hÃ¬nh khÃ¡c)
# ============================

protected-mode no
# Táº¯t cháº¿ Ä‘á»™ báº£o vá»‡ tá»± Ä‘á»™ng (chá»‰ cho phÃ©p truy cáº­p tá»« localhost).
# => Gá»¢I Ã:
#    + Náº¿u protected-mode táº¯t, báº¯t buá»™c pháº£i báº­t requirepass hoáº·c firewall cháº·n port Redis.
#    + Náº¿u khÃ´ng, Redis server sáº½ ráº¥t dá»… bá»‹ táº¥n cÃ´ng!

# ============================
# Gá»¢I Ã Bá»” SUNG Tá»”NG THá»‚:
# ============================

# ğŸ’¡ Náº¿u má»¥c tiÃªu benchmark hiá»‡u nÄƒng cá»±c cao:
#    - Táº¡m thá»i: appendonly no, save ""
#    - Giáº£m logging xuá»‘ng warning hoáº·c tháº¥p hÆ¡n.
#    - Tá»‘i Æ°u kernel tcp stack (tcp_tw_reuse, tcp_fin_timeout).

# ğŸ’¡ Náº¿u Redis cháº¡y trÃªn server nhiá»u CPU core:
#    - CÃ¢n nháº¯c cháº¡y nhiá»u Redis instance nhá» thay vÃ¬ 1 instance to (há»— trá»£ Ä‘a core tá»‘t hÆ¡n).

# ğŸ’¡ Náº¿u yÃªu cáº§u HA (High Availability):
#    - DÃ¹ng Redis Sentinel (theo Ä‘Ãºng config báº¡n Ä‘ang setup).
#    - Hoáº·c cÃ¢n nháº¯c Redis Cluster náº¿u dataset ráº¥t lá»›n (>10GB).

# ğŸ’¡ Náº¿u workload chá»§ yáº¿u Ä‘á»c (read-heavy):
#    - Táº­n dá»¥ng replica Ä‘á»ƒ scale Ä‘á»c ra nhiá»u node.

# ğŸ’¡ Náº¿u workload chá»§ yáº¿u ghi (write-heavy):
#    - Tá»‘i Æ°u appendfsync vÃ  kiá»ƒm tra performance á»• cá»©ng.