# ============================
# Redis Sentinel configuration
# ============================

port 26379
# Port mÃ  Sentinel sáº½ láº¯ng nghe. 
# => Máº·c Ä‘á»‹nh Sentinel cháº¡y trÃªn 26379 (khÃ´ng nÃªn trÃ¹ng port Redis).

sentinel resolve-hostnames yes
# Cho phÃ©p Sentinel resolve hostname thÃ nh IP (há»¯u Ã­ch trong mÃ´i trÆ°á»ng Docker hoáº·c Kubernetes).

sentinel announce-hostnames yes
# Náº¿u báº­t, Sentinel sáº½ cÃ´ng bá»‘ hostname thay vÃ¬ IP khi gá»­i info tá»›i cÃ¡c client khÃ¡c.
# => Gá»¢I Ã: NÃªn báº­t trong mÃ´i trÆ°á»ng Ä‘á»™ng (Docker, Cloud) khi IP thay Ä‘á»•i liÃªn tá»¥c.

# ============================
# Monitor the master
# ============================

# Format: sentinel monitor <master-name> <master-hostname> <master-port> <quorum>
sentinel monitor mymaster redis-master 6379 2
# Cáº¥u hÃ¬nh Sentinel Ä‘á»ƒ giÃ¡m sÃ¡t master.
# - mymaster: tÃªn logical Ä‘áº·t cho master
# - redis-master: hostname (service name) cá»§a master Redis
# - 6379: cá»•ng Redis master
# - 2: quorum: Sá»‘ Sentinel cáº§n Ä‘á»“ng Ã½ ráº±ng master "down" trÆ°á»›c khi failover.

# => Gá»¢I Ã:
#    + Quorum >= (Sá»‘ Sentinel / 2) + 1
#    + Äá»ƒ Ä‘áº£m báº£o HA thá»±c sá»±, cáº§n Ã­t nháº¥t 3 Sentinel nodes trá»Ÿ lÃªn.

# ============================
# Down and failover settings
# ============================

sentinel down-after-milliseconds mymaster 3000
# Thá»i gian (ms) sau Ä‘Ã³ Sentinel sáº½ coi master lÃ  "down" náº¿u khÃ´ng nháº­n Ä‘Æ°á»£c pháº£n há»“i.
# => Gá»¢I Ã:
#    + Äá»ƒ giÃ¡ trá»‹ khÃ´ng quÃ¡ tháº¥p (3s há»£p lÃ½).
#    + Náº¿u network thÆ°á»ng xuyÃªn trá»…, cÃ³ thá»ƒ set 5000 hoáº·c 10000.

sentinel failover-timeout mymaster 30000
# Tá»•ng thá»i gian timeout cho quÃ¡ trÃ¬nh failover (30 giÃ¢y).
# Bao gá»“m: phÃ¡t hiá»‡n down, báº§u chá»n, chá»n replica, promote.

# ============================
# Set number of replicas to have after failover
# ============================

sentinel parallel-syncs mymaster 1
# Sá»‘ lÆ°á»£ng replica cÃ³ thá»ƒ Ä‘á»“ng bá»™ song song cÃ¹ng lÃºc khi cÃ³ master má»›i.
# => Gá»¢I Ã:
#    + Náº¿u nhiá»u replica (3+), cÃ³ thá»ƒ tÄƒng lÃªn 2-3 Ä‘á»ƒ Ä‘áº©y nhanh sync.

# ============================
# Client reconfiguration
# ============================

# Client-reconfig-script Ä‘á»ƒ cáº­p nháº­t á»©ng dá»¥ng khi master thay Ä‘á»•i (tÃ¹y chá»n)
# sentinel client-reconfig-script mymaster /path/to/script.sh
# => Script nÃ y sáº½ cháº¡y khi failover thÃ nh cÃ´ng, Ä‘á»ƒ client biáº¿t vÃ  update config.
# => Ráº¥t há»¯u Ã­ch náº¿u app khÃ´ng tá»± Ä‘á»™ng cáº­p nháº­t thÃ´ng tin master má»›i.

# ============================
# Authentication settings (Báº£o máº­t)
# ============================

# Set authentication if needed
# sentinel auth-pass mymaster your_password_here
# Náº¿u master yÃªu cáº§u password, thÃ¬ Sentinel cáº§n thiáº¿t láº­p auth-pass Ä‘á»ƒ káº¿t ná»‘i.
# => Gá»¢I Ã:
#    + Báº¯t buá»™c cáº¥u hÃ¬nh náº¿u báº¡n enable requirepass trÃªn master/replica.

# ============================
# Sentinel ID uniqueness
# ============================

sentinel deny-scripts-reconfig no
# Cho phÃ©p thay Ä‘á»•i cáº¥u hÃ¬nh tá»« script hoáº·c command.
# => Gá»¢I Ã:
#    + Náº¿u báº¡n muá»‘n ngÄƒn viá»‡c update config tá»« bÃªn ngoÃ i, set deny-scripts-reconfig yes.

# ============================
# Other settings
# ============================

protected-mode no
# Táº¯t cháº¿ Ä‘á»™ protected mode.
# => Gá»¢I Ã:
#    + Cáº§n Ä‘áº£m báº£o network ná»™i bá»™ an toÃ n.
#    + Náº¿u expose Sentinel ra internet, báº¯t buá»™c Ä‘á»ƒ protected-mode yes hoáº·c dÃ¹ng firewall cháº·n truy cáº­p.
  
# ============================
# Gá»¢I Ã Bá»” SUNG Tá»”NG THá»‚:
# ============================

# ğŸ’¡ Production Setup khuyáº¿n nghá»‹:
#    - 3 hoáº·c 5 Sentinel nodes (sá»‘ láº») Ä‘á»ƒ quorum há»£p lá»‡.
#    - CÃ¡c Sentinel nÃªn Ä‘Æ°á»£c deploy trÃªn cÃ¡c server váº­t lÃ½/VM khÃ¡c nhau Ä‘á»ƒ trÃ¡nh single point of failure.
#    - Báº­t announce-hostnames náº¿u há»‡ thá»‘ng Ä‘á»™ng (Docker Swarm, Kubernetes).
#    - Cáº¥u hÃ¬nh alert (Prometheus/Alertmanager hoáº·c Email) Ä‘á»ƒ biáº¿t khi nÃ o failover xáº£y ra.
#    - Náº¿u dÃ¹ng SSL/TLS, cáº§n proxy layer ngoÃ i (Redis 7 má»›i há»— trá»£ TLS native).
#
# ğŸ’¡ Kiá»ƒm tra liÃªn tá»¥c vá»›i lá»‡nh:
#    redis-cli -p 26379 SENTINEL masters
#    redis-cli -p 26379 SENTINEL replicas mymaster
#    redis-cli -p 26379 SENTINEL sentinels mymaster
